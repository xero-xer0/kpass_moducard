<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>K-íŒ¨ìŠ¤ 'ëª¨ë‘ì˜ ì¹´ë“œ' ê³„ì‚°ê¸°</title>
    <style>
        /* [ê¸°ë³¸ ìŠ¤íƒ€ì¼] */
        body {
            font-family: 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif;
            background-color: #f4f6f9;
            color: #333;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            transition: background-color 0.3s;
            /* ëª¨ë°”ì¼ í„°ì¹˜ í•˜ì´ë¼ì´íŠ¸ ì œê±° */
            -webkit-tap-highlight-color: transparent;
        }

        .card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            padding: 25px;
            margin-bottom: 20px;
        }

        h2 {
            text-align: center;
            color: #004094;
            margin-bottom: 5px;
        }

        h4 {
            text-align: center;
            color: #666;
            font-weight: normal;
            margin-top: 0;
            font-size: 0.9em;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 1.05em;
        }

        select {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #ddd;
            font-size: 16px;
            box-sizing: border-box;
            background-color: #fff;
            cursor: pointer;
        }

        /* ê¸°ì¤€ê¸ˆì•¡ ë°•ìŠ¤ (í…Œë§ˆë³„ ë¶„ë¦¬) */
        .threshold-container {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
        }

        .th-box {
            flex: 1;
            padding: 15px 0;
            border-radius: 10px;
            text-align: center;
            border: 2px solid;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .th-box.general {
            background-color: #e6fffa;
            border-color: #00b894;
            color: #00796b;
        }

        .th-box.plus {
            background-color: #e7f5ff;
            border-color: #228be6;
            color: #1864ab;
        }

        .th-label {
            font-size: 0.85em;
            font-weight: normal;
            margin-bottom: 5px;
            opacity: 0.9;
        }

        .th-value {
            font-size: 1.3em;
            font-weight: 800;
            letter-spacing: -0.5px;
            font-variant-numeric: tabular-nums;
        }

        /* ì»¨íŠ¸ë¡¤ ë ˆì´ì•„ì›ƒ */
        .control-layout {
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }

        .slider-wrapper {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-width: 0;
        }

        .input-wrapper {
            width: 140px;
            flex-shrink: 0;
            position: relative;
            transition: width 0.2s;
        }

        input[type="range"] {
            width: 100%;
            cursor: pointer;
            height: 25px;
            margin: 0 0 8px 0;
            /* [í™•ëŒ€ ë°©ì§€] í„°ì¹˜ ì¡°ì‘ ìµœì í™” */
            touch-action: manipulation;

            /* [ë°°ê²½ìƒ‰ ë³´ì •: Hybrid Fix] */
            /* 1. Native Thumb ìœ ì§€ë¥¼ ìœ„í•´ appearance: auto (ê¸°ë³¸ê°’) ì‚¬ìš© */
            /* 2. íŠ¸ë™ ë°°ê²½(Gradient)ì„ ê·¸ë¦¬ê¸° ìœ„í•œ ì„¤ì • */
            /* 3. [Refinement] Chromeì—ì„œ Green Accent ì‹œ Black Track ê°•ì œ ë°©ì§€ -> Light Mode ê°•ì œ */
            color-scheme: light;

            background-color: transparent;
            background-repeat: no-repeat;
            background-position: center;
            background-size: 100% 4px;
            /* Native Trackê³¼ ìœ ì‚¬í•œ ë‘ê»˜ */
        }

        /* [Hue Rotation Fix] Chromeì˜ Green Accent Black Track ë²„ê·¸ ìš°íšŒ */
        /* 1. Baseë¥¼ Blue(#228be6)ë¡œ ì„¤ì •í•˜ì—¬ ê¹¨ë—í•œ íŠ¸ë™ì„ í™•ë³´ */
        /* 2. hue-rotate(-40deg)ë¡œ Blue(208) -> Green(168)ìœ¼ë¡œ ì‹œê°ì  ë³€í™˜ */
        #generalSlider {
            accent-color: #228be6;
            filter: hue-rotate(-40deg);
        }

        /* 3. Chromeì˜ Native Track(ê²€ì€ìƒ‰ ì´ìŠˆ)ì€ íˆ¬ëª…í•˜ê²Œ ìˆ¨ê¹€ */
        input[type="range"]::-webkit-slider-runnable-track {
            /* [Nuclear Fix] íŠ¸ë™ë§Œ ê°•ì œë¡œ Native Appearanceë¥¼ ë„ê³  íˆ¬ëª…í™” */
            background: transparent;
        }

        /*
           ì›ë³µ: ì»¤ìŠ¤í…€ íŠ¸ë™/í•¸ë“¤ ìŠ¤íƒ€ì¼ ì œê±°
           ì‚¬ìš©ìê°€ ì˜¤ë¦¬ì§€ë„ ë””ìì¸ì„ ê°•ë ¥íˆ ì›í•¨.
        */

        input[type="number"] {
            width: 100%;
            padding: 10px 35px 10px 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            color: #333;
            text-align: right;
            box-sizing: border-box;
            font-variant-numeric: tabular-nums;
            height: 46px;
            touch-action: manipulation;
        }

        input[type="number"]:focus {
            outline: none;
        }

        .unit-text {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #888;
            font-size: 0.9em;
            font-weight: normal;
        }

        .btn-group {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            justify-content: center;
            width: 100%;
        }

        .quick-btn {
            background-color: #f1f3f5;
            border: 1px solid #e9ecef;
            color: #495057;
            padding: 8px 10px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8em;
            font-weight: 600;
            transition: all 0.1s;
            flex-grow: 1;
            max-width: 60px;
            white-space: nowrap;
            /* [í™•ëŒ€ ë°©ì§€] ë”ë¸”íƒ­ ì¤Œ ë¹„í™œì„±í™” */
            touch-action: manipulation;
            user-select: none;
            -webkit-user-select: none;
        }

        .quick-btn:hover {
            background-color: #e9ecef;
        }

        .quick-btn:active {
            transform: scale(0.96);
            background-color: #dee2e6;
        }

        .quick-btn.minus {
            color: #fa5252;
            background-color: #fff5f5;
            border-color: #ffe3e3;
        }

        .quick-btn.minus:hover {
            background-color: #ffe3e3;
        }

        .quick-btn.plus {
            color: #228be6;
            background-color: #e7f5ff;
            border-color: #d0ebff;
        }

        .quick-btn.plus:hover {
            background-color: #d0ebff;
        }

        /* í…Œë§ˆë³„ ìŠ¤íƒ€ì¼ */
        .section-general label {
            color: #009688;
        }

        .section-general input[type="range"] {
            accent-color: #00b894;
        }

        .section-general input[type="number"]:focus {
            border-color: #00b894;
        }

        .section-general .quick-btn.plus {
            color: #009688;
            background-color: #e0f2f1;
            border-color: #b2dfdb;
        }

        .section-general .quick-btn.plus:hover {
            background-color: #b2dfdb;
        }

        .section-plus label {
            color: #1971c2;
        }

        .section-plus input[type="range"] {
            accent-color: #228be6;
        }

        .section-plus input[type="number"]:focus {
            border-color: #228be6;
        }

        /* ê²°ê³¼ ë°•ìŠ¤ */
        .result-box {
            border-radius: 12px;
            padding: 25px 15px;
            text-align: center;
            border: 2px solid;
            min-height: 160px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: all 0.4s ease;
        }

        .result-box.theme-basic {
            background-color: #f8f9fa;
            border-color: #343a40;
        }

        .result-box.theme-basic .badge {
            background-color: #343a40;
        }

        .result-box.theme-basic .highlight-text {
            color: #343a40;
        }

        .result-box.theme-general {
            background-color: #e6fffa;
            border-color: #00b894;
        }

        .result-box.theme-general .badge {
            background-color: #00b894;
        }

        .result-box.theme-general .highlight-text {
            color: #00b894;
        }

        .result-box.theme-plus {
            background-color: #e7f5ff;
            border-color: #228be6;
        }

        .result-box.theme-plus .badge {
            background-color: #228be6;
        }

        .result-box.theme-plus .highlight-text {
            color: #228be6;
        }

        .badge {
            padding: 6px 15px;
            border-radius: 20px;
            color: white;
            font-size: 0.9em;
            font-weight: bold;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            transition: background-color 0.4s;
        }

        .equation-wrapper {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            gap: 8px;
            width: 100%;
        }

        .eq-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .eq-label {
            font-size: 0.75em;
            color: #777;
            margin-bottom: 4px;
        }

        .eq-value {
            font-size: 1.1em;
            font-weight: 600;
            color: #555;
            font-variant-numeric: tabular-nums;
        }

        .eq-operator {
            font-size: 1.5em;
            color: #adb5bd;
            margin: 15px 5px 0 5px;
            font-weight: 300;
        }

        .eq-value.highlight-text {
            font-size: 2.4em;
            font-weight: 800;
            line-height: 1;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        }

        .eq-value.final-cost {
            font-size: 1.3em;
            font-weight: 800;
            color: #333;
            text-decoration: underline;
            text-decoration-color: #ddd;
            text-underline-offset: 4px;
        }

        .comparison-table {
            width: 100%;
            margin-top: 25px;
            border-collapse: collapse;
            font-size: 0.9em;
            table-layout: fixed;
        }

        .comparison-table th,
        .comparison-table td {
            padding: 10px;
            border-bottom: 1px solid #eee;
            text-align: center;
            font-variant-numeric: tabular-nums;
        }

        .comparison-table th {
            background-color: #f8f9fa;
            color: #666;
            font-weight: 600;
        }

        .winner-row {
            background-color: #fff9db;
            font-weight: bold;
        }

        /* [ëª¨ë°”ì¼ ìµœì í™”] í™”ë©´ ë„ˆë¹„ 768px ì´í•˜ */
        @media (max-width: 768px) {
            body {
                padding: 15px;
            }

            .card {
                padding: 20px 15px;
            }

            /* ì…ë ¥ì°½ ë„ˆë¹„ ì¶•ì†Œ */
            .input-wrapper {
                width: 90px;
            }

            input[type="number"] {
                font-size: 16px;
                padding: 10px 5px;
                padding-right: 22px;
            }

            .unit-text {
                right: 5px;
                font-size: 0.8em;
            }

            /* ë²„íŠ¼ í•œ ì¤„ ê°•ì œ & ê°„ê²© ì¡°ì ˆ */
            .btn-group {
                flex-wrap: nowrap;
                gap: 3px;
            }

            .quick-btn {
                font-size: 11px;
                padding: 10px 0;
                /* í„°ì¹˜ ì˜ì—­ í™•ë³´ */
                min-width: 0;
                flex: 1;
            }

            .control-layout {
                gap: 10px;
            }

            .threshold-container {
                gap: 10px;
            }

            .eq-value.highlight-text {
                font-size: 2em;
            }

            .eq-operator {
                font-size: 1.2em;
                margin: 10px 2px 0 2px;
            }
        }
    </style>
</head>

<body>

    <div class="card">
        <h2>K-íŒ¨ìŠ¤ ëª¨ë‘ì˜ ì¹´ë“œ ê³„ì‚°ê¸°</h2>
        <h4>2025ë…„ 12ì›” êµ­í† êµí†µë¶€ ë³´ë„ìë£Œ ê¸°ì¤€</h4>

        <div class="form-group">
            <label>1. ê±°ì£¼ ì§€ì—­</label>
            <select id="region" onchange="calculate()">
                <option value="capital">ìˆ˜ë„ê¶Œ (ì„œìš¸/ê²½ê¸°/ì¸ì²œ)</option>
                <option value="local">ì¼ë°˜ ì§€ë°©ê¶Œ</option>
                <option value="priority">ìš°ëŒ€ì§€ì›ì§€ì—­</option>
                <option value="special">íŠ¹ë³„ì§€ì›ì§€ì—­</option>
            </select>
        </div>

        <div class="form-group">
            <label>2. ì´ìš©ì ìœ í˜•</label>
            <select id="userType" onchange="calculate()">
                <option value="general">ì¼ë°˜ì¸ (ê¸°ë³¸ 20%)</option>
                <option value="youth">ì²­ë…„ (ë§Œ19~34ì„¸, 30%)</option>
                <option value="senior">ì–´ë¥´ì‹  (ë§Œ65ì„¸ ì´ìƒ, 30%)</option>
                <option value="child2">2ìë…€ ê°€êµ¬ (30%)</option>
                <option value="child3">3ìë…€ ì´ìƒ ê°€êµ¬ (50%)</option>
                <option value="lowIncome">ì €ì†Œë“ì¸µ (53.3%)</option>
            </select>
        </div>

        <div class="threshold-container">
            <div class="th-box general">
                <span class="th-label">ğŸšŒ ì¼ë°˜í˜• ê³µì œê¸°ì¤€</span>
                <span class="th-value" id="limitGenDisplay">62,000ì›</span>
            </div>

            <div class="th-box plus">
                <span class="th-label">ğŸš„ í”ŒëŸ¬ìŠ¤í˜• ê³µì œê¸°ì¤€</span>
                <span class="th-value" id="limitPlusDisplay">100,000ì›</span>
            </div>
        </div>

        <hr style="border: 0; border-top: 1px solid #eee; margin: 25px 0;">

        <div class="form-group section-general">
            <label>ğŸšŒ ì¼ë°˜ ëŒ€ì¤‘êµí†µ <span style="font-weight:normal; font-size:0.85em; opacity: 0.8;">(3ì²œì› ë¯¸ë§Œ)</span></label>

            <div class="control-layout">
                <div class="slider-wrapper">
                    <input type="range" id="generalSlider" min="0" max="300000" step="1000" value="60000"
                        oninput="syncValues('general', 'slider')">

                    <div class="btn-group">
                        <button class="quick-btn minus" onclick="adjustValue('general', -10000)">-1ë§Œ</button>
                        <button class="quick-btn minus" onclick="adjustValue('general', -5000)">-5ì²œ</button>
                        <button class="quick-btn minus" onclick="adjustValue('general', -1000)">-1ì²œ</button>
                        <button class="quick-btn plus" onclick="adjustValue('general', 1000)">+1ì²œ</button>
                        <button class="quick-btn plus" onclick="adjustValue('general', 5000)">+5ì²œ</button>
                        <button class="quick-btn plus" onclick="adjustValue('general', 10000)">+1ë§Œ</button>
                    </div>
                </div>
                <div class="input-wrapper">
                    <input type="number" id="generalInput" value="60000" step="100"
                        oninput="syncValues('general', 'input')">
                    <span class="unit-text">ì›</span>
                </div>
            </div>
        </div>

        <div class="form-group section-plus">
            <label>ğŸš„ í”ŒëŸ¬ìŠ¤ ëŒ€ì¤‘êµí†µ <span style="font-weight:normal; font-size:0.85em; opacity: 0.8;">(GTX ë“±)</span></label>

            <div class="control-layout">
                <div class="slider-wrapper">
                    <input type="range" id="plusSlider" min="0" max="300000" step="1000" value="0"
                        oninput="syncValues('plus', 'slider')">

                    <div class="btn-group">
                        <button class="quick-btn minus" onclick="adjustValue('plus', -10000)">-1ë§Œ</button>
                        <button class="quick-btn minus" onclick="adjustValue('plus', -5000)">-5ì²œ</button>
                        <button class="quick-btn minus" onclick="adjustValue('plus', -1000)">-1ì²œ</button>
                        <button class="quick-btn plus" onclick="adjustValue('plus', 1000)">+1ì²œ</button>
                        <button class="quick-btn plus" onclick="adjustValue('plus', 5000)">+5ì²œ</button>
                        <button class="quick-btn plus" onclick="adjustValue('plus', 10000)">+1ë§Œ</button>
                    </div>
                </div>
                <div class="input-wrapper">
                    <input type="number" id="plusInput" value="0" step="100" oninput="syncValues('plus', 'input')">
                    <span class="unit-text">ì›</span>
                </div>
            </div>
        </div>
    </div>

    <div class="card">
        <div id="resultBox" class="result-box theme-basic">
            <div class="badge" id="appliedMethodBadge">ê³„ì‚° ê²°ê³¼</div>

            <div class="equation-wrapper">
                <div class="eq-item">
                    <div class="eq-label">ì´ ì§€ì¶œ</div>
                    <div class="eq-value" id="totalSpend">0</div>
                </div>

                <div class="eq-operator">-</div>

                <div class="eq-item">
                    <div class="eq-label">ì˜ˆìƒ í™˜ê¸‰ê¸ˆ</div>
                    <div class="eq-value highlight-text" id="refundAmount">0</div>
                </div>

                <div class="eq-operator">=</div>

                <div class="eq-item">
                    <div class="eq-label">ì‹¤ì œ ë¶€ë‹´ê¸ˆ</div>
                    <div class="eq-value final-cost" id="realCost">0</div>
                </div>
            </div>

            <!-- [15íšŒ ë¯¸ë§Œ ê²½ê³  ë¬¸êµ¬] -->
            <div id="warning-msg"
                style="display:none; color: #e67e22; font-size: 0.9em; margin-top: 15px; width: 100%; border-top: 1px dashed rgba(0,0,0,0.1); padding-top: 10px; font-weight: 600;">
                ğŸ’¡ ì›” 15íšŒ ë¯¸ë§Œ ì´ìš© ì‹œ ì ë¦½ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤ (ê°€ì… ì²« ë‹¬ ì œì™¸)
            </div>
        </div>

        <table class="comparison-table">
            <colgroup>
                <col style="width: 25%">
                <col style="width: 45%">
                <col style="width: 30%">
            </colgroup>
            <thead>
                <tr>
                    <th>ìœ í˜•</th>
                    <th>ìƒì„¸ ë‚´ìš©</th>
                    <th>í™˜ê¸‰ì•¡</th>
                </tr>
            </thead>
            <tbody id="comparisonBody"></tbody>
        </table>

        <p style="text-align: center; color: #aaa; font-size: 0.8em; margin-top: 20px;">
            *ë³¸ ì‹œë®¬ë ˆì´ì…˜ ê²°ê³¼ëŠ” ì˜ˆìƒì¹˜ì´ë©° ì‹¤ì œì™€ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        </p>
    </div>

    <script>
        const thresholds = {
            capital: { g1: [62000, 100000], g2: [55000, 90000], g3: [45000, 80000] },
            local: { g1: [55000, 95000], g2: [50000, 85000], g3: [40000, 75000] },
            priority: { g1: [50000, 90000], g2: [45000, 80000], g3: [35000, 70000] },
            special: { g1: [45000, 85000], g2: [40000, 75000], g3: [30000, 65000] }
        };

        const basicRates = {
            general: 0.2, youth: 0.3, senior: 0.3, child2: 0.3, child3: 0.5, lowIncome: 0.533
        };

        const groupMapping = {
            general: 'g1', youth: 'g2', senior: 'g2', child2: 'g2', child3: 'g3', lowIncome: 'g3'
        };

        const fmt = (num) => new Intl.NumberFormat('ko-KR').format(Math.floor(num));

        function syncValues(type, source) {
            const slider = document.getElementById(type + 'Slider');
            const input = document.getElementById(type + 'Input');
            if (source === 'slider') input.value = slider.value;
            else {
                if (Number(input.value) > 300000) input.value = 300000;
                slider.value = input.value;
            }
            updateSliderTrack(slider); // [Hybrid Fix] íŠ¸ë™ ìƒ‰ìƒ ì—…ë°ì´íŠ¸
            calculate();
        }

        // [Hybrid Fix] ìŠ¬ë¼ì´ë” ë°°ê²½(Gradient) ë™ì  ì—…ë°ì´íŠ¸
        function updateSliderTrack(slider) {
            const min = Number(slider.min) || 0;
            const max = Number(slider.max) || 100;
            const val = Number(slider.value) || 0;

            const percentage = ((val - min) / (max - min)) * 100;

            // ìƒ‰ìƒ ê²°ì • 
            let color = "#adb5bd"; // ê¸°ë³¸
            if (slider.id.includes('general')) {
                // [Hue Rotation Fix] ì‹¤ì œë¡œëŠ” Blueë¥¼ ê·¸ë¦¬ê³ , CSS filterë¡œ Greenìœ¼ë¡œ ë³´ì´ê²Œ í•¨
                color = "#228be6";
            }
            else if (slider.id.includes('plus')) color = "#228be6";

            // Gradient ë°°ê²½ ì ìš© (íŠ¸ë™ ì±„ì›€ íš¨ê³¼)
            slider.style.backgroundImage = `linear-gradient(to right, ${color} 0%, ${color} ${percentage}%, #e9ecef ${percentage}%, #e9ecef 100%)`;
        }

        function adjustValue(type, amount) {
            const input = document.getElementById(type + 'Input');
            let currentVal = Number(input.value) || 0;
            let newVal = currentVal + amount;
            if (newVal < 0) newVal = 0;
            if (newVal > 300000) newVal = 300000;
            input.value = newVal;
            syncValues(type, 'input');
        }

        // ì´ˆê¸°í™”
        window.addEventListener('DOMContentLoaded', () => {
            updateSliderTrack(document.getElementById('generalSlider'));
            updateSliderTrack(document.getElementById('plusSlider'));
            calculate();
        });

        function calculate() {
            const region = document.getElementById('region').value;
            const userType = document.getElementById('userType').value;

            const genSpend = Number(document.getElementById('generalInput').value) || 0;
            const plusSpend = Number(document.getElementById('plusInput').value) || 0;
            const totalSpend = genSpend + plusSpend;

            const group = groupMapping[userType];
            const limits = thresholds[region][group];
            const limitGen = limits[0];
            const limitPlus = limits[1];
            const rate = basicRates[userType];

            document.getElementById('limitGenDisplay').textContent = fmt(limitGen) + "ì›";
            document.getElementById('limitPlusDisplay').textContent = fmt(limitPlus) + "ì›";

            const refundBasic = Math.floor(totalSpend * rate);
            let refundEveryoneGen = Math.max(0, genSpend - limitGen);
            let refundEveryonePlus = Math.max(0, totalSpend - limitPlus);

            const maxRefund = Math.max(refundBasic, refundEveryoneGen, refundEveryonePlus);

            let bestMethod = "";
            let themeClass = "theme-basic";

            if (maxRefund === refundBasic) {
                bestMethod = "ê¸°ë³¸ K-íŒ¨ìŠ¤ (ì •ë¥ í˜•)";
                themeClass = "theme-basic";
            } else if (maxRefund === refundEveryoneGen) {
                bestMethod = "ëª¨ë‘ì˜ ì¹´ë“œ (ì¼ë°˜í˜•)";
                themeClass = "theme-general";
            } else {
                bestMethod = "ëª¨ë‘ì˜ ì¹´ë“œ (í”ŒëŸ¬ìŠ¤í˜•)";
                themeClass = "theme-plus";
            }

            const resultBox = document.getElementById('resultBox');
            resultBox.className = `result-box ${themeClass}`;

            document.getElementById('appliedMethodBadge').textContent = "ìµœì  ì ìš©: " + bestMethod;
            document.getElementById('totalSpend').textContent = fmt(totalSpend);
            document.getElementById('refundAmount').textContent = fmt(maxRefund);

            // K-íŒ¨ìŠ¤/ëª¨ë‘ì˜ ì¹´ë“œ ê¸°ì¤€ ì‹¤ë¶€ë‹´ê¸ˆ
            const kpassRealCost = totalSpend - maxRefund;
            document.getElementById('realCost').textContent = fmt(kpassRealCost);

            // --- ê¸°í›„ë™í–‰ì¹´ë“œ ë¹„êµ ë¡œì§ (ìˆ˜ë„ê¶Œ í•œì •) ---
            let climateHtml = '';
            let climateRowHtml = '';

            if (region === 'capital') {
                // ê¸°í›„ë™í–‰ì¹´ë“œ ê°€ê²© (ë”°ë¦‰ì´ ì œì™¸ ê¸°ì¤€)
                // ì²­ë…„(ë§Œ19~39ì„¸) 55,000ì›, ê·¸ ì™¸ 62,000ì›
                const climateCardPrice = (userType === 'youth') ? 55000 : 62000;

                // ê¸°í›„ë™í–‰ ì‹¤ë¶€ë‹´ = ì¹´ë“œê°’ + í”ŒëŸ¬ìŠ¤ì´ìš©ê¸ˆì•¡(ë³„ë„)
                const climateRealCost = climateCardPrice + plusSpend;
                const diff = climateRealCost - kpassRealCost; // ì–‘ìˆ˜ë©´ KíŒ¨ìŠ¤ê°€ ì´ë“, ìŒìˆ˜ë©´ ê¸°í›„ë™í–‰ì´ ì´ë“

                let diffText = "";
                let diffClass = "";
                let diffColor = "";

                if (diff > 0) {
                    diffText = `${fmt(diff)}ì› ì†í•´`;
                    diffColor = "#fa5252"; // ë¶‰ì€ìƒ‰ (ì†í•´)
                } else if (diff < 0) {
                    diffText = `${fmt(Math.abs(diff))}ì› ì´ë“`;
                    diffColor = "#228be6"; // íŒŒë€ìƒ‰ (ì´ë“)
                } else {
                    diffText = "ë™ì¼";
                    diffColor = "#888";
                }

                // ê²°ê³¼ ë°•ìŠ¤ í•˜ë‹¨ í‘œì‹œìš© HTML
                climateHtml = `
                <div style="margin-top: 15px; padding-top: 15px; border-top: 1px dashed rgba(0,0,0,0.1); width: 100%;">
                    <div style="font-size: 0.95em; color: #555; margin-bottom: 5px;">
                        ğŸŸï¸ <strong>ê¸°í›„ë™í–‰ì¹´ë“œ</strong> ì‚¬ìš© ì‹œ
                        <span style="font-size: 0.85em; color: #888; font-weight: normal;">
                            (${userType === 'youth' ? 'ì²­ë…„' : 'ì¼ë°˜'} ${fmt(climateCardPrice)}ì› + í”ŒëŸ¬ìŠ¤ ë³„ë„)
                        </span>
                    </div>
                    <div style="font-size: 1.1em; font-weight: bold;">
                        ì‹¤ë¶€ë‹´ <span style="font-family: inherit;">${fmt(climateRealCost)}</span>ì›
                        <span style="margin-left: 8px; font-size: 0.95em; color: ${diffColor}; background: rgba(255,255,255,0.5); padding: 2px 6px; border-radius: 4px;">
                            (${diffText})
                        </span>
                    </div>
                </div>
            `;

                // ë¹„êµ í…Œì´ë¸”ìš© í–‰ HTML
                const isClimateWinner = (diff < 0);
                climateRowHtml = `
                <tr class="${isClimateWinner ? 'winner-row' : ''}" style="border-top: 2px solid #eee;">
                    <td>ê¸°í›„ë™í–‰ì¹´ë“œ</td>
                    <td>
                        ì¹´ë“œ ${fmt(climateCardPrice)}ì›<br>
                        <span style="font-size:0.85em; color:#888;">+ í”ŒëŸ¬ìŠ¤ ${fmt(plusSpend)}ì›</span>
                    </td>
                    <td>
                        -
                    </td>
                </tr>
            `;
            }

            // ê²°ê³¼ ë°•ìŠ¤ì— ê¸°í›„ë™í–‰ ë¹„êµ êµ¬ë¬¸ ì¶”ê°€ (ê¸°ì¡´ ë‚´ìš© ë’¤ì— append)
            // ì£¼ì˜: ë§¤ë²ˆ innerHTMLì„ ë®ì–´ì“°ë¯€ë¡œ, ìœ„ì—ì„œ ê³„ì‚°ëœ ê°’ë“¤ì„ ì•ˆì „í•˜ê²Œ ë„£ì–´ì•¼ í•¨.
            // ê¸°ì¡´ DOM êµ¬ì¡°ë¥¼ ìœ ì§€í•˜ë©´ì„œ ì¶”ê°€í•˜ê¸° ìœ„í•´ ì•„ë˜ì™€ ê°™ì´ ì²˜ë¦¬í•˜ì§€ ì•Šê³ 
            // eq-value ë°‘ì— ë³„ë„ ê³µê°„ì„ ë¯¸ë¦¬ ë§Œë“¤ì–´ë‘ê±°ë‚˜, ì—¬ê¸°ì„œ innerHTMLì„ ì¡°ì‘.
            // ì—¬ê¸°ì„œëŠ” ê°„ë‹¨íˆ resultBox ë‚´ë¶€ì˜ ë§ˆì§€ë§‰ì— ì¶”ê°€ëœ divê°€ ìˆë‹¤ë©´ ê°±ì‹ , ì—†ë‹¤ë©´ ì¶”ê°€í•˜ëŠ” ë°©ì‹ë³´ë‹¤ëŠ”
            // ë§¤ë²ˆ ìƒˆë¡œ ê·¸ë¦¬ëŠ” ê¸°ì¡´ ë¡œì§(calculate í•¨ìˆ˜ ë‚´ì—ì„œ ê°’ë§Œ ë³€ê²½)ê³¼ ë‹¬ë¦¬
            // êµ¬ì¡°ë¥¼ ë³€ê²½í•´ì•¼ í•˜ë¯€ë¡œ, ìœ„ìª½ì—ì„œ equation-wrapper ë‹¤ìŒ ìš”ì†Œë¡œ ì œì–´í•˜ëŠ” ê²ƒì´ ì¢‹ìŒ.

            // í˜„ì¬ resultBox êµ¬ì¡°: badge -> equation-wrapper
            // ë”°ë¼ì„œ equation-wrapper ë’¤ì— climate-info divë¥¼ ì°¾ì•„ì„œ ì—…ë°ì´íŠ¸í•˜ê±°ë‚˜ ì¶”ê°€.

            let climateInfoDiv = document.getElementById('climateInfo');
            if (!climateInfoDiv) {
                climateInfoDiv = document.createElement('div');
                climateInfoDiv.id = 'climateInfo';
                // equation-wrapper ë°”ë¡œ ë’¤ì— ì‚½ì…
                const wrapper = resultBox.querySelector('.equation-wrapper');
                if (wrapper) wrapper.after(climateInfoDiv);
                else resultBox.appendChild(climateInfoDiv);
            }
            climateInfoDiv.innerHTML = climateHtml;


            const tbody = document.getElementById('comparisonBody');
            tbody.innerHTML = `
            <tr class="${maxRefund === refundBasic ? 'winner-row' : ''}">
                <td>ê¸°ë³¸í˜•</td>
                <td>${(rate * 100).toFixed(1)}% ì ë¦½</td>
                <td>${fmt(refundBasic)}ì›</td>
            </tr>
            <tr class="${maxRefund === refundEveryoneGen ? 'winner-row' : ''}">
                <td>ëª¨ë‘ì˜ ì¹´ë“œ<br>(ì¼ë°˜)</td>
                <td>ì¼ë°˜ - ${fmt(limitGen)}ì›</td>
                <td>${fmt(refundEveryoneGen)}ì›</td>
            </tr>
            <tr class="${maxRefund === refundEveryonePlus ? 'winner-row' : ''}">
                <td>ëª¨ë‘ì˜ ì¹´ë“œ<br>(í”ŒëŸ¬ìŠ¤)</td>
                <td>ì´ì•¡ - ${fmt(limitPlus)}ì›</td>
                <td>${fmt(refundEveryonePlus)}ì›</td>
            </tr>
            ${climateRowHtml}
        `;

            // 5. [15íšŒ ë¯¸ë§Œ ì´ìš© ì‹œ ê²½ê³ ] 
            // ê¸°ì¤€: ê¸°ë³¸ìš”ê¸ˆ 1,500ì› ê¸°ì¤€ 15íšŒ = 22,500ì›
            const warningMsg = document.getElementById('warning-msg');

            // 0ì›ì¼ ë•ŒëŠ” ê²½ê³  ìˆ¨ê¹€ (ì´ˆê¸° ìƒíƒœ í˜¹ì€ ì…ë ¥ ì¤‘)
            if (warningMsg) {
                if (totalSpend > 0 && totalSpend < 22500) {
                    warningMsg.style.display = 'block';
                } else {
                    warningMsg.style.display = 'none';
                }
            }
        }

        calculate();
    </script>
</body>

</html>
