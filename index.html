<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K-íŒ¨ìŠ¤ 'ëª¨ë‘ì˜ ì¹´ë“œ' ê³„ì‚°ê¸°</title>
    <style>
        body { font-family: 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif; background-color: #f4f6f9; color: #333; max-width: 600px; margin: 0 auto; padding: 20px; transition: background-color 0.3s; }
        .card { background: white; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); padding: 25px; margin-bottom: 20px; }
        
        h2 { text-align: center; color: #004094; margin-bottom: 5px; }
        h4 { text-align: center; color: #666; font-weight: normal; margin-top: 0; font-size: 0.9em; margin-bottom: 30px; }
        
        .form-group { margin-bottom: 20px; }
        label { display: block; font-weight: bold; margin-bottom: 8px; font-size: 1.05em; }
        select { width: 100%; padding: 12px; border-radius: 8px; border: 1px solid #ddd; font-size: 16px; box-sizing: border-box; background-color: #fff; cursor: pointer; }
        
        /* [ë³€ê²½] ê¸°ì¤€ê¸ˆì•¡ ë°•ìŠ¤ ë¶„ë¦¬ ë ˆì´ì•„ì›ƒ */
        .threshold-container {
            display: flex;
            gap: 15px; /* ë‘ ë°•ìŠ¤ ì‚¬ì´ ê°„ê²© */
            margin-bottom: 30px;
        }

        .th-box {
            flex: 1; /* 1:1 ë¹„ìœ¨ë¡œ 50%ì”© ì°¨ì§€ */
            padding: 15px 0;
            border-radius: 10px;
            text-align: center;
            border: 2px solid; /* í…Œë‘ë¦¬ ê°•ì¡° */
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        /* ì¼ë°˜í˜• ë°•ìŠ¤ í…Œë§ˆ (Mint/Green) */
        .th-box.general {
            background-color: #e6fffa;
            border-color: #00b894;
            color: #00796b;
        }
        
        /* í”ŒëŸ¬ìŠ¤í˜• ë°•ìŠ¤ í…Œë§ˆ (Blue) */
        .th-box.plus {
            background-color: #e7f5ff;
            border-color: #228be6;
            color: #1864ab;
        }

        .th-label { font-size: 0.85em; font-weight: normal; margin-bottom: 5px; opacity: 0.9; }
        .th-value { font-size: 1.3em; font-weight: 800; letter-spacing: -0.5px; } 

        /* ì»¨íŠ¸ë¡¤ ë ˆì´ì•„ì›ƒ */
        .control-layout { display: flex; align-items: flex-start; gap: 15px; }
        .slider-wrapper { flex-grow: 1; display: flex; flex-direction: column; justify-content: center; }
        .input-wrapper { width: 140px; flex-shrink: 0; position: relative; }

        input[type="range"] { width: 100%; cursor: pointer; height: 25px; margin: 0 0 8px 0; }
        
        input[type="number"] { 
            width: 100%; padding: 10px 35px 10px 10px; 
            border: 2px solid #e0e0e0; border-radius: 8px; 
            font-size: 18px; font-weight: bold; color: #333; text-align: right;
            box-sizing: border-box;
            font-variant-numeric: tabular-nums;
            height: 46px; 
        }
        input[type="number"]:focus { outline: none; }
        .unit-text { position: absolute; right: 12px; top: 50%; transform: translateY(-50%); color: #888; font-size: 0.9em; font-weight: normal;}

        .btn-group { display: flex; flex-wrap: wrap; gap: 5px; justify-content: center; width: 100%; }
        .quick-btn {
            background-color: #f1f3f5; border: 1px solid #e9ecef; color: #495057;
            padding: 8px 10px; border-radius: 6px; cursor: pointer; font-size: 0.8em; font-weight: 600;
            transition: all 0.15s; flex-grow: 1; max-width: 60px;
        }
        .quick-btn:hover { background-color: #e9ecef; }
        .quick-btn:active { transform: scale(0.96); }
        .quick-btn.minus { color: #fa5252; background-color: #fff5f5; border-color: #ffe3e3; }
        .quick-btn.minus:hover { background-color: #ffe3e3; }
        .quick-btn.plus { color: #228be6; background-color: #e7f5ff; border-color: #d0ebff; }
        .quick-btn.plus:hover { background-color: #d0ebff; }

        /* í…Œë§ˆë³„ ìŠ¬ë¼ì´ë” ìŠ¤íƒ€ì¼ */
        .section-general label { color: #009688; }
        .section-general input[type="range"] { accent-color: #00b894; }
        .section-general input[type="number"]:focus { border-color: #00b894; }
        .section-general .quick-btn.plus { color: #009688; background-color: #e0f2f1; border-color: #b2dfdb; }
        .section-general .quick-btn.plus:hover { background-color: #b2dfdb; }

        .section-plus label { color: #1971c2; }
        .section-plus input[type="range"] { accent-color: #228be6; }
        .section-plus input[type="number"]:focus { border-color: #228be6; }

        /* ê²°ê³¼ ë°•ìŠ¤ */
        .result-box { 
            border-radius: 12px; padding: 25px 15px; text-align: center; border: 2px solid; 
            min-height: 160px; display: flex; flex-direction: column; justify-content: center; align-items: center;
            transition: all 0.4s ease;
        }
        .result-box.theme-basic { background-color: #f8f9fa; border-color: #343a40; }
        .result-box.theme-basic .badge { background-color: #343a40; }
        .result-box.theme-basic .highlight-text { color: #343a40; }
        
        .result-box.theme-general { background-color: #e6fffa; border-color: #00b894; }
        .result-box.theme-general .badge { background-color: #00b894; }
        .result-box.theme-general .highlight-text { color: #00b894; }

        .result-box.theme-plus { background-color: #e7f5ff; border-color: #228be6; }
        .result-box.theme-plus .badge { background-color: #228be6; }
        .result-box.theme-plus .highlight-text { color: #228be6; }

        .badge { 
            padding: 6px 15px; border-radius: 20px; color: white; font-size: 0.9em; font-weight: bold; margin-bottom: 20px; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.1); transition: background-color 0.4s;
        }

        .equation-wrapper { display: flex; align-items: center; justify-content: center; flex-wrap: wrap; gap: 8px; width: 100%; }
        .eq-item { display: flex; flex-direction: column; align-items: center; }
        .eq-label { font-size: 0.75em; color: #777; margin-bottom: 4px; }
        .eq-value { font-size: 1.1em; font-weight: 600; color: #555; font-variant-numeric: tabular-nums; }
        .eq-operator { font-size: 1.5em; color: #adb5bd; margin: 15px 5px 0 5px; font-weight: 300; }
        .eq-value.highlight-text { font-size: 2.4em; font-weight: 800; line-height: 1; text-shadow: 0 1px 2px rgba(0,0,0,0.05); }
        .eq-value.final-cost { font-size: 1.3em; font-weight: 800; color: #333; text-decoration: underline; text-decoration-color: #ddd; text-underline-offset: 4px; }

        .comparison-table { width: 100%; margin-top: 25px; border-collapse: collapse; font-size: 0.9em; table-layout: fixed; }
        .comparison-table th, .comparison-table td { padding: 10px; border-bottom: 1px solid #eee; text-align: center; font-variant-numeric: tabular-nums; }
        .comparison-table th { background-color: #f8f9fa; color: #666; font-weight: 600; }
        .winner-row { background-color: #fff9db; font-weight: bold; }

        @media (max-width: 450px) {
            .equation-wrapper { gap: 2px; }
            .eq-operator { margin: 15px 2px 0 2px; font-size: 1.2em; }
            .eq-value.highlight-text { font-size: 1.8em; }
            .eq-value { font-size: 1em; }
            .quick-btn { padding: 8px 6px; font-size: 0.75em; }
        }
    </style>
</head>
<body>

    <div class="card">
        <h2>K-íŒ¨ìŠ¤ ëª¨ë‘ì˜ ì¹´ë“œ ê³„ì‚°ê¸°</h2>
        <h4>2025ë…„ 12ì›” êµ­í† êµí†µë¶€ ë³´ë„ìë£Œ ê¸°ì¤€</h4>
        
        <div class="form-group">
            <label>1. ê±°ì£¼ ì§€ì—­</label>
            <select id="region" onchange="calculate()">
                <option value="capital">ìˆ˜ë„ê¶Œ (ì„œìš¸/ê²½ê¸°/ì¸ì²œ)</option>
                <option value="local">ì¼ë°˜ ì§€ë°©ê¶Œ</option>
                <option value="priority">ìš°ëŒ€ì§€ì›ì§€ì—­</option>
                <option value="special">íŠ¹ë³„ì§€ì›ì§€ì—­</option>
            </select>
        </div>

        <div class="form-group">
            <label>2. ì´ìš©ì ìœ í˜•</label>
            <select id="userType" onchange="calculate()">
                <option value="general">ì¼ë°˜ì¸ (ê¸°ë³¸ 20%)</option>
                <option value="youth">ì²­ë…„ (ë§Œ19~34ì„¸, 30%)</option>
                <option value="senior">ì–´ë¥´ì‹  (ë§Œ65ì„¸ ì´ìƒ, 30%)</option>
                <option value="child2">2ìë…€ ê°€êµ¬ (30%)</option>
                <option value="child3">3ìë…€ ì´ìƒ ê°€êµ¬ (50%)</option>
                <option value="lowIncome">ì €ì†Œë“ì¸µ (53.3%)</option>
            </select>
        </div>

        <div class="threshold-container">
            <div class="th-box general">
                <span class="th-label">ğŸšŒ ì¼ë°˜í˜• ê³µì œê¸°ì¤€</span>
                <span class="th-value" id="limitGenDisplay">62,000ì›</span>
            </div>
            
            <div class="th-box plus">
                <span class="th-label">ğŸš„ í”ŒëŸ¬ìŠ¤í˜• ê³µì œê¸°ì¤€</span>
                <span class="th-value" id="limitPlusDisplay">100,000ì›</span>
            </div>
        </div>

        <hr style="border: 0; border-top: 1px solid #eee; margin: 25px 0;">

        <div class="form-group section-general">
            <label>ğŸšŒ ì¼ë°˜ ëŒ€ì¤‘êµí†µ <span style="font-weight:normal; font-size:0.85em; opacity: 0.8;">(3ì²œì› ë¯¸ë§Œ)</span></label>
            
            <div class="control-layout">
                <div class="slider-wrapper">
                    <input type="range" id="generalSlider" min="0" max="300000" step="1000" value="60000" 
                           oninput="syncValues('general', 'slider')">
                    
                    <div class="btn-group">
                        <button class="quick-btn minus" onclick="adjustValue('general', -10000)">-1ë§Œ</button>
                        <button class="quick-btn minus" onclick="adjustValue('general', -5000)">-5ì²œ</button>
                        <button class="quick-btn minus" onclick="adjustValue('general', -1000)">-1ì²œ</button>
                        <button class="quick-btn plus" onclick="adjustValue('general', 1000)">+1ì²œ</button>
                        <button class="quick-btn plus" onclick="adjustValue('general', 5000)">+5ì²œ</button>
                        <button class="quick-btn plus" onclick="adjustValue('general', 10000)">+1ë§Œ</button>
                    </div>
                </div>
                <div class="input-wrapper">
                    <input type="number" id="generalInput" value="60000" step="100" 
                           oninput="syncValues('general', 'input')">
                    <span class="unit-text">ì›</span>
                </div>
            </div>
        </div>

        <div class="form-group section-plus">
            <label>ğŸš„ í”ŒëŸ¬ìŠ¤ ëŒ€ì¤‘êµí†µ <span style="font-weight:normal; font-size:0.85em; opacity: 0.8;">(GTX ë“±)</span></label>
            
            <div class="control-layout">
                <div class="slider-wrapper">
                    <input type="range" id="plusSlider" min="0" max="300000" step="1000" value="0" 
                           oninput="syncValues('plus', 'slider')">
                           
                    <div class="btn-group">
                        <button class="quick-btn minus" onclick="adjustValue('plus', -10000)">-1ë§Œ</button>
                        <button class="quick-btn minus" onclick="adjustValue('plus', -5000)">-5ì²œ</button>
                        <button class="quick-btn minus" onclick="adjustValue('plus', -1000)">-1ì²œ</button>
                        <button class="quick-btn plus" onclick="adjustValue('plus', 1000)">+1ì²œ</button>
                        <button class="quick-btn plus" onclick="adjustValue('plus', 5000)">+5ì²œ</button>
                        <button class="quick-btn plus" onclick="adjustValue('plus', 10000)">+1ë§Œ</button>
                    </div>
                </div>
                <div class="input-wrapper">
                    <input type="number" id="plusInput" value="0" step="100" 
                           oninput="syncValues('plus', 'input')">
                    <span class="unit-text">ì›</span>
                </div>
            </div>
        </div>
    </div>

    <div class="card">
        <div id="resultBox" class="result-box theme-basic">
            <div class="badge" id="appliedMethodBadge">ê³„ì‚° ê²°ê³¼</div>
            
            <div class="equation-wrapper">
                <div class="eq-item">
                    <div class="eq-label">ì´ ì§€ì¶œ</div>
                    <div class="eq-value" id="totalSpend">0</div>
                </div>
                
                <div class="eq-operator">-</div>
                
                <div class="eq-item">
                    <div class="eq-label">ì˜ˆìƒ í™˜ê¸‰ê¸ˆ</div>
                    <div class="eq-value highlight-text" id="refundAmount">0</div>
                </div>
                
                <div class="eq-operator">=</div>
                
                <div class="eq-item">
                    <div class="eq-label">ì‹¤ì œ ë¶€ë‹´ê¸ˆ</div>
                    <div class="eq-value final-cost" id="realCost">0</div>
                </div>
            </div>
        </div>

        <table class="comparison-table">
            <colgroup>
                <col style="width: 25%">
                <col style="width: 45%">
                <col style="width: 30%">
            </colgroup>
            <thead>
                <tr>
                    <th>ìœ í˜•</th>
                    <th>ìƒì„¸ ë‚´ìš©</th>
                    <th>í™˜ê¸‰ì•¡</th>
                </tr>
            </thead>
            <tbody id="comparisonBody"></tbody>
        </table>
        
        <p style="text-align: center; color: #aaa; font-size: 0.8em; margin-top: 20px;">
            *ë³¸ ì‹œë®¬ë ˆì´ì…˜ ê²°ê³¼ëŠ” ì˜ˆìƒì¹˜ì´ë©° ì‹¤ì œì™€ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        </p>
    </div>

<script>
    const thresholds = {
        capital: { g1: [62000, 100000], g2: [55000, 90000], g3: [45000, 80000] },
        local: { g1: [55000, 95000], g2: [50000, 85000], g3: [40000, 75000] },
        priority: { g1: [50000, 90000], g2: [45000, 80000], g3: [35000, 70000] },
        special: { g1: [45000, 85000], g2: [40000, 75000], g3: [30000, 65000] }
    };

    const basicRates = {
        general: 0.2, youth: 0.3, senior: 0.3, child2: 0.3, child3: 0.5, lowIncome: 0.533
    };

    const groupMapping = {
        general: 'g1', youth: 'g2', senior: 'g2', child2: 'g2', child3: 'g3', lowIncome: 'g3'
    };

    const fmt = (num) => new Intl.NumberFormat('ko-KR').format(Math.floor(num));

    function syncValues(type, source) {
        const slider = document.getElementById(type + 'Slider');
        const input = document.getElementById(type + 'Input');
        if (source === 'slider') input.value = slider.value;
        else {
            if(Number(input.value) > 300000) input.value = 300000;
            slider.value = input.value;
        }
        calculate();
    }

    function adjustValue(type, amount) {
        const input = document.getElementById(type + 'Input');
        let currentVal = Number(input.value) || 0;
        let newVal = currentVal + amount;
        if (newVal < 0) newVal = 0;
        if (newVal > 300000) newVal = 300000;
        input.value = newVal;
        syncValues(type, 'input');
    }

    function calculate() {
        const region = document.getElementById('region').value;
        const userType = document.getElementById('userType').value;
        
        const genSpend = Number(document.getElementById('generalInput').value) || 0;
        const plusSpend = Number(document.getElementById('plusInput').value) || 0;
        const totalSpend = genSpend + plusSpend;

        const group = groupMapping[userType];
        const limits = thresholds[region][group]; 
        const limitGen = limits[0];
        const limitPlus = limits[1];
        const rate = basicRates[userType];

        document.getElementById('limitGenDisplay').textContent = fmt(limitGen) + "ì›";
        document.getElementById('limitPlusDisplay').textContent = fmt(limitPlus) + "ì›";

        const refundBasic = Math.floor(totalSpend * rate);
        let refundEveryoneGen = Math.max(0, genSpend - limitGen);
        let refundEveryonePlus = Math.max(0, totalSpend - limitPlus);

        const maxRefund = Math.max(refundBasic, refundEveryoneGen, refundEveryonePlus);
        
        let bestMethod = "";
        let themeClass = "theme-basic";

        if (maxRefund === refundBasic) {
            bestMethod = "ê¸°ë³¸ K-íŒ¨ìŠ¤ (ì •ë¥ í˜•)";
            themeClass = "theme-basic";
        } else if (maxRefund === refundEveryoneGen) {
            bestMethod = "ëª¨ë‘ì˜ ì¹´ë“œ (ì¼ë°˜í˜•)";
            themeClass = "theme-general";
        } else {
            bestMethod = "ëª¨ë‘ì˜ ì¹´ë“œ (í”ŒëŸ¬ìŠ¤í˜•)";
            themeClass = "theme-plus";
        }

        const resultBox = document.getElementById('resultBox');
        resultBox.className = `result-box ${themeClass}`;
        
        document.getElementById('appliedMethodBadge').textContent = "ìµœì  ì ìš©: " + bestMethod;
        document.getElementById('totalSpend').textContent = fmt(totalSpend);
        document.getElementById('refundAmount').textContent = fmt(maxRefund);
        document.getElementById('realCost').textContent = fmt(totalSpend - maxRefund);

        const tbody = document.getElementById('comparisonBody');
        tbody.innerHTML = `
            <tr class="${maxRefund === refundBasic ? 'winner-row' : ''}">
                <td>ê¸°ë³¸í˜•</td>
                <td>${(rate*100).toFixed(1)}% ì ë¦½</td>
                <td>${fmt(refundBasic)}ì›</td>
            </tr>
            <tr class="${maxRefund === refundEveryoneGen ? 'winner-row' : ''}">
                <td>ëª¨ë‘ì˜ ì¹´ë“œ<br>(ì¼ë°˜)</td>
                <td>ì¼ë°˜ - ${fmt(limitGen)}ì›</td>
                <td>${fmt(refundEveryoneGen)}ì›</td>
            </tr>
            <tr class="${maxRefund === refundEveryonePlus ? 'winner-row' : ''}">
                <td>ëª¨ë‘ì˜ ì¹´ë“œ<br>(í”ŒëŸ¬ìŠ¤)</td>
                <td>ì´ì•¡ - ${fmt(limitPlus)}ì›</td>
                <td>${fmt(refundEveryonePlus)}ì›</td>
            </tr>
        `;
    }

    calculate();
</script>
</body>
</html>
